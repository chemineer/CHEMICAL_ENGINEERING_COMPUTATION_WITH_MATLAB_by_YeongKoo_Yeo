function propvalue = satH2Oprop(dtype, phH2O, dvalue) 
% satH2Oprop.m: properties of saturated H2O (water and steam) 
% Based on the revised release on the IAPWS Industrial formulation 1997 for 
% the Thermodynamic Properties of Water and Steam, August 2007 (Ref[1]). 
% To find properties of superheated steam, use H2Oprop.m 
% 
% Basic syntax: w = satH2Oprop(dtype, phH2O, dvalue) 
% Inputs: 
% dtype: data type( 'P' = pressure, 'T' = temperature) 
% phH2O: phase of H2O ('V' = vapor, 'L' = liquid) 
% dvalue: value of pressure(kPa) or temperature(deg.C) 
% Output: 
% w- structure of property values (T,P,H,S,U, or V) of saturated H2O 
% w.P: saturation pressure (kPa) 
% w.T: saturation temperature (deg.C) 
% w.H: specific enthalpy (kJ/kg) 
% w.S: specific entropy (kJ/(kg-K)) 
% w.U: specific internal energy (kJ/kg) 
% w.V: specific volume (cm^3/g) 
% 
% Examples: 
% x = satH2Oprop('P','L',10420) returns the properties of saturated 
% liquid at P = 10420 kPa 
% x = satH2Oprop('T','V',220) returns the properties of saturated vapor 
% at T = 220 degC 

dtype = upper(dtype); % dtype = 'P' or 'T' 
phH2O = upper(phH2O); % phH2O = 'V' or 'L' 
switch dtype    
case 'P' % Properties at P(kPa)        
P = dvalue/1000; % kPa -> MPa        
propvalue.P = P*1e3;        
if P > 0.000611657  && P < 22.06395            
propvalue.T = Ts4(P) - 273.15; % Saturation temperature(deg.C) at P        
else            
propvalue.T = NaN; propvalue.H = NaN; propvalue.S = NaN;            
propvalue.U = NaN; propvalue.V = NaN; return;        
end        
switch phH2O            
case 'V' % Properties of saturated vapor at P (kPa)                
propvalue.H = H4Vp(P); % Saturated vapor enthalpy at P                
if P < 16.529                    
propvalue.S = S2pt(P,Ts4(P)); % Saturated vapor entropy at P                    
propvalue.U = U2pt(P,Ts4(P)); % Saturated vapor internal energy at P                    
propvalue.V = V2pt(P,Ts4(P))*1e3; % Saturated vapor volume at P                
else   
propvalue.S = S3rt(1/(V3ph(P,H4Vp(P))),Ts4(P)); % Saturated vapor entropy at P                     
propvalue.U = U3rt(1/(V3ph(P,H4Vp(P))),Ts4(P)); % Saturated vapor internal  
energy at P  
propvalue.V = V3ph(P,H4Vp(P))*1e3; % Saturated vapor volume at P                
end            
case 'L' % Properties of saturated liquid at P (kPa)                
propvalue.H = H4Lp(P); % Saturated liquid enthalpy at P                
if P < 16.529                    
propvalue.S = S1pt(P,Ts4(P)); % Saturated liquid entropy at P                    
propvalue.U = U1pt(P,Ts4(P)); % Saturated liquid internal energy at P                    
propvalue.V = V1pt(P,Ts4(P))*1e3; % Saturated liquid volume at P   
else 
propvalue.S = S3rt(1/(V3ph(P,H4Lp(P))),Ts4(P)); % Saturated liquid entropy at P         
propvalue.U = U3rt(1/(V3ph(P,H4Lp(P))),Ts4(P)); % Saturated liquid internal  
energy at P                          
propvalue.V = V3ph(P,H4Lp(P))*1e3; % Saturated liquid volume at P                
end        
end    
case 'T' % Properties at T(deg.C)        
T = dvalue + 273.15; % deg.C -> K        
propvalue.T = dvalue;        
if T < 647.096  && T > 273.15            
propvalue.P = Ps4(T)*1e3; % Saturation pressure(kPa) at T(deg.C)        
else            
propvalue.P = NaN; propvalue.H = NaN; propvalue.S = NaN;            
propvalue.U = NaN; propvalue.V = NaN; return;       
end        
switch phH2O            
case 'V' % Properties of saturated vapor at T(deg.C)                
propvalue.H = H4Vp(Ps4(T)); % Saturated vapor enthalpy at T                
if T <= 623.15                    
propvalue.S = S2pt(Ps4(T),T); % Saturated vapor entropy at T                    
propvalue.U = U2pt(Ps4(T),T); % Saturated vapor internal energy at T                    
propvalue.V = V2pt(Ps4(T),T)*1e3; % Saturated vapor volume at T                                    

else                    
propvalue.S = S3rt(1/(V3ph(Ps4(T),H4Vp(Ps4(T)))),T); % Saturated vap. entropy at T                     
propvalue.U = U3rt(1/(V3ph(Ps4(T),H4Vp(Ps4(T)))),T); % Saturated vap.  
internal energy at T                   
propvalue.V = V3ph(Ps4(T),H4Vp(Ps4(T)))*1e3; % Saturated vapor  
volume at T                 
end             
case 'L' % Properties of saturated liquid at P(kPa)                  
propvalue.H = H4Lp(Ps4(T)); % Saturated liquid enthalpy at T                    
if T <= 623.15                  
propvalue.S = S1pt(Ps4(T),T); % Saturated liquid entropy at T                     
propvalue.U = U1pt(Ps4(T),T); % Saturated liquid internal energy at T                     
propvalue.V = V1pt(Ps4(T),T)*1e3;  % Saturated liquid volume at T                 
else                     
propvalue.S = S3rt(1/(V3ph(Ps4(T),H4Lp(Ps4(T)))),T); % Saturated liq. entropy at T                   
propvalue.U = U3rt(1/(V3ph(Ps4(T), H4Lp(Ps4(T)))), T); % Saturated liq. internal          
energy at T                   
propvalue.V = V3ph(Ps4(T),H4Lp(Ps4(T)))*1e3;  % Saturated liquid volume at T                
end        
end 
end 
end  

% Equations for region 1 ------------------------------------------------- 
function H1 = H1pt(P,T) 
% Eqn.(7) (Ref[1]) 
% Parameters: Table 2 (Ref[1]) 
Ii = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3,...         
3, 4, 4, 4, 5, 8, 8, 21, 23, 29, 30, 31, 32]; 
Ji = [-2, -1, 0, 1, 2, 3, 4, 5, -9, -7, -1, 0, 1, 3, -3, 0, 1, 3, 17,...         
-4, 0, 6, -5, -2, 10, -8, -11, -6, -29, -31, -38, -39, -40, -41]; 
ni = [0.14632971213167, -0.84548187169114, -3.756360367204, 3.3855169168385,... 
-0.95791963387872, 0.15772038513228, -0.016616417199501, 8.1214629983568e-04,...        
2.8319080123804e-04, -6.0706301565874e-04, -0.018990068218419,...       
-0.032529748770505, -0.021841717175414, -5.283835796993e-05,...       
-4.7184321073267e-04, -3.0001780793026e-04, 4.7661393906987e-05,...       
-4.4141845330846e-06, -7.2694996297594e-16, -3.1679644845054e-05,...        
-2.8270797985312e-06, -8.5205128120103e-10, -2.2425281908e-06,...        
-6.5171222895601e-07, -1.4341729937924e-13, -4.0516996860117e-07,...        
-1.2734301741641e-09, -1.7424871230634e-10, -6.8762131295531e-19,...        
1.4478307828521e-20, 2.6335781662795e-23, -1.1947622640071e-23,...        
1.8228094581404e-24, -9.3537087292458e-26]; 
R = 0.461526; % kJ/(kg-K) 
pv = P/16.53; tau = 1386/T; % pv = P/P*, tau = T*/T, P*=16.53 Mpa, T*=1386K 
gt = 0;  
for i = 1:34, gt = gt + (ni(i)*(7.1 - pv)^Ii(i) * Ji(i)*(tau-1.222)^(Ji(i)- 1)); end 
H1 = R*T*tau*gt; 
end  

function S1 = S1pt(P,T) 
% Eqn.(7) (Ref[1]) 
% Parameters: Table 2 (Ref[1]) 
Ii = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3,...         
4, 4, 4, 5, 8, 8, 21, 23, 29, 30, 31, 32]; 
Ji = [-2, -1, 0, 1, 2, 3, 4, 5, -9, -7, -1, 0, 1, 3, -3, 0, 1, 3, 17,...         
-4, 0, 6, -5, -2, 10, -8, -11, -6, -29, -31, -38, -39, -40, -41]; 
ni = [0.14632971213167, -0.84548187169114, -3.756360367204,...         
3.3855169168385, -0.95791963387872, 0.15772038513228,...        
-0.016616417199501, 8.1214629983568e-04, 2.8319080123804e-04,...        
-6.0706301565874e-04, -0.018990068218419, -0.032529748770505,...        
-0.021841717175414, -5.283835796993e-05, -4.7184321073267e-04,...        
-3.0001780793026e-04, 4.7661393906987e-05, -4.4141845330846e-06,...        
-7.2694996297594e-16, -3.1679644845054e-05, -2.8270797985312e-06,...        
-8.5205128120103e-10, -2.2425281908e-06, -6.5171222895601e-07,...        
-1.4341729937924e-13, -4.0516996860117e-07, -1.2734301741641e-09,...        
-1.7424871230634e-10, -6.8762131295531e-19, 1.4478307828521e-20,...         
2.6335781662795e-23, -1.1947622640071e-23, 1.8228094581404e-24,...       
-9.3537087292458e-26]; 
R = 0.461526; %kJ/(kg-K) 
pv = P/16.53; tau = 1386/T; % pv = P/P*, tau = T*/T, P*=16.53 Mpa, T*=1386K 
gam = 0; gamt = 0; 
for i = 1:34    
gamt = gamt + (ni(i)*(7.1-pv)^Ii(i) * Ji(i) * (tau-1.222)^(Ji(i) - 1));    
gam = gam + ni(i)*(7.1-pv)^Ii(i) * (tau-1.222)^Ji(i); % g(P,T)/(RT) 
end 
S1 = R*tau*gamt - R*gam; 
end  

function U1 = U1pt(P,T) 
% Eqn.(7) (Ref[1]) 
% Parameters: Table 2 (Ref[1]) 
Ii = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3,...         
4, 4, 4, 5, 8, 8, 21, 23, 29, 30, 31, 32]; 
Ji = [-2, -1, 0, 1, 2, 3, 4, 5, -9, -7, -1, 0, 1, 3, -3, 0, 1, 3, 17,...         
-4, 0, 6, -5, -2, 10, -8, -11, -6, -29, -31, -38, -39, -40, -41]; 
ni = [0.14632971213167, -0.84548187169114, -3.756360367204,... 
3.3855169168385, -0.95791963387872, 0.15772038513228,...       
-0.016616417199501, 8.1214629983568e-04, 2.8319080123804e-04,...       
-6.0706301565874e-04, -0.018990068218419, -0.032529748770505,...       
-0.021841717175414, -5.283835796993e-05, -4.7184321073267e-04,...       
-3.0001780793026e-04, 4.7661393906987e-05, -4.4141845330846e-06,...       
-7.2694996297594e-16, -3.1679644845054e-05, -2.8270797985312e-06,...       
-8.5205128120103e-10, -2.2425281908e-06, -6.5171222895601e-07,...       
-1.4341729937924e-13, -4.0516996860117e-07, -1.2734301741641e-09,...       
-1.7424871230634e-10, -6.8762131295531e-19, 1.4478307828521e-20,...         
2.6335781662795e-23, -1.1947622640071e-23, 1.8228094581404e-24,...       
-9.3537087292458e-26]; 
R = 0.461526; % kJ/(kg-K) 
pv = P/16.53; tau = 1386/T; % pv = P/P*, tau = T*/T, P*=16.53 Mpa, T*=1386K 
gt = 0; gp = 0; 
for i = 1:34    
gp = gp - ni(i)*Ii(i)*(7.1-pv)^(Ii(i)-1) * (tau-1.222)^Ji(i);    
gt = gt + (ni(i)*(7.1-pv)^Ii(i) * Ji(i)*(tau-1.222)^(Ji(i)-1)); 
end 
U1 = R*T*(tau*gt - pv*gp); 
end  

function V1 = V1pt(P,T) 
% Eqn.(7) (Ref[1]) 
% Parameters: Table 2 (Ref[1]) 
Ii = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3,...         
4, 4, 4, 5, 8, 8, 21, 23, 29, 30, 31, 32]; 
Ji = [-2, -1, 0, 1, 2, 3, 4, 5, -9, -7, -1, 0, 1, 3, -3, 0, 1, 3, 17,...          
-4, 0, 6, -5, -2, 10, -8, -11, -6, -29, -31, -38, -39, -40, -41]; 
ni = [0.14632971213167, -0.84548187169114, -3.756360367204,...         
3.3855169168385, -0.95791963387872, 0.15772038513228,...       
-0.016616417199501, 8.1214629983568e-04, 2.8319080123804e-04,...       
-6.0706301565874e-04, -0.018990068218419, -0.032529748770505,...       
-0.021841717175414, -5.283835796993e-05, -4.7184321073267e-04,...       
-3.0001780793026e-04, 4.7661393906987e-05, -4.4141845330846e-06,...       
-7.2694996297594e-16, -3.1679644845054e-05, -2.8270797985312e-06,...       
-8.5205128120103e-10, -2.2425281908e-06, -6.5171222895601e-07,...       
-1.4341729937924e-13, -4.0516996860117e-07, -1.2734301741641e-09,...       
-1.7424871230634e-10, -6.8762131295531e-19, 1.4478307828521e-20,...         
2.6335781662795e-23, -1.1947622640071e-23, 1.8228094581404e-24,...       
-9.3537087292458e-26]; 
R = 0.461526; %kJ/(kg K) 
pv = P/16.53; tau = 1386/T; % pv = P/P*, tau = T*/T, P*=16.53 Mpa, T*=1386K 
gp = 0; 
for i = 1:34, gp = gp - ni(i)*Ii(i)*(7.1-pv)^(Ii(i)-1) * (tau-1.222)^Ji(i); end 
V1 = R*T*pv*gp/P/1000; 
end  

% Equations for region 2 ------------------------------------------------- 
function H2 = H2pt(P,T) 
% Parameters: Table 10 and 11 (Ref[1]) 
Ji0 = [0, 1, -5, -4, -3, -2, -1, 2, 3]; 
ni0 = [-9.6927686500217, 10.086655968018, -0.005608791128302,...           
0.071452738081455, -0.40710498223928, 1.4240819171444,...    
-4.383951131945, -0.28408632460772, 0.021268463753307]; 
Ii = [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 5, 6, 6, 6,... 
7, 7, 7, 8, 8, 9, 10, 10, 10, 16, 16, 18, 20, 20, 20, 21, 22, 23,...         
24, 24, 24]; 
Ji = [0, 1, 2, 3, 6, 1, 2, 4, 7, 36, 0, 1, 3, 6, 35, 1, 2, 3, 7, 3, 16,...         
35, 0, 11, 25, 8, 36, 13, 4, 10, 14, 29, 50, 57, 20, 35, 48, 21, 53,...         
39, 26, 40, 58]; 
ni = [-1.7731742473213e-03, -0.017834862292358, -0.045996013696365,...          
-0.057581259083432, -0.05032527872793, -3.3032641670203e-05,...          
-1.8948987516315e-04, -3.9392777243355e-03, -0.043797295650573,...          
-2.6674547914087e-05, 2.0481737692309e-08, 4.3870667284435e-07,...          
-3.227767723857e-05, -1.5033924542148e-03, -0.040668253562649,...          
-7.8847309559367e-10, 1.2790717852285e-08, 4.8225372718507e-07,...            
2.2922076337661e-06, -1.6714766451061e-11, -2.1171472321355e-03,...          
-23.895741934104, -5.905956432427e-18, -1.2621808899101e-06,...          
-0.038946842435739, 1.1256211360459e-11, -8.2311340897998,...            
1.9809712802088e-08, 1.0406965210174e-19, -1.0234747095929e-13,...           
-1.0018179379511e-09, -8.0882908646985e-11, 0.10693031879409,...           
-0.33662250574171, 8.9185845355421e-25, 3.0629316876232e-13,...           
-4.2002467698208e-06, -5.9056029685639e-26, 3.7826947613457e-06,...           
-1.2768608934681e-15, 7.3087610595061e-29, 5.5414715350778e-17,...           
-9.436970724121e-07]; 
R = 0.461526; % kJ/(kg-K) 
pv = P; tau = 540/T; % pv = P/P*, tau = T*/T, P*=1 Mpa, T*=540 K 
% Eqns in Table 14 (Ref[1]) 
gt0 = 0; 
for i = 1:9, gt0 = gt0 + ni0(i)*Ji0(i)*tau^(Ji0(i)-1); end 
gtr = 0; 
for i = 1:43, gtr = gtr + ni(i) * pv^Ii(i) * Ji(i)*(tau-0.5)^(Ji(i)-1); end 
H2 = R*T*tau*(gt0 + gtr); % Specific enthalpy (Table 12, Ref[1]) 
end  

function S2 = S2pt(P,T) 
% Parameters: Table 10 and 11 (Ref[1]) 
Ji0 = [0, 1, -5, -4, -3, -2, -1, 2, 3]; 
ni0 = [-9.6927686500217, 10.086655968018, -0.005608791128302,...            
0.071452738081455, -0.40710498223928, 1.4240819171444,...            
-4.383951131945, -0.28408632460772, 0.021268463753307]; 
Ii = [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 5, 6, 6, 6,...         
7, 7, 7, 8, 8, 9, 10, 10, 10, 16, 16, 18, 20, 20, 20, 21, 22, 23,...         
24, 24, 24]; 
Ji = [0, 1, 2, 3, 6, 1, 2, 4, 7, 36, 0, 1, 3, 6, 35, 1, 2, 3, 7, 3, 16,...         
35, 0, 11, 25, 8, 36, 13, 4, 10, 14, 29, 50, 57, 20, 35, 48, 21, 53,...         
39, 26, 40, 58]; 
ni = [-1.7731742473213e-03, -0.017834862292358, -0.045996013696365,...        
-0.057581259083432, -0.05032527872793, -3.3032641670203e-05,...        
-1.8948987516315e-04, -3.9392777243355e-03, -0.043797295650573,...        
-2.6674547914087e-05, 2.0481737692309e-08, 4.3870667284435e-07,...        
-3.227767723857e-05, -1.5033924542148e-03, -0.040668253562649,...        
-7.8847309559367e-10, 1.2790717852285e-08, 4.8225372718507e-07,...         
2.2922076337661e-06, -1.6714766451061e-11, -2.1171472321355e-03,...         
-23.895741934104, -5.905956432427e-18, -1.2621808899101e-06,...         
-0.038946842435739, 1.1256211360459e-11, -8.2311340897998,...          
1.9809712802088e-08, 1.0406965210174e-19, -1.0234747095929e-13,...          
-1.0018179379511e-09, -8.0882908646985e-11, 0.10693031879409,...         
-0.33662250574171, 8.9185845355421e-25, 3.0629316876232e-13,...         
-4.2002467698208e-06, -5.9056029685639e-26, 3.7826947613457e-06,... 
-1.2768608934681e-15, 7.3087610595061e-29, 5.5414715350778e-17,...         
-9.436970724121e-07]; 
R = 0.461526; %kJ/(kg-K) 
pv = P; tau = 540/T; % pv = P/P*, tau = T*/T, P*=1 Mpa, T*=540 K 
% Eqns in Table 12 and 13 (Ref[1]) 
g0 = log(pv); gt0 = 0; 
for i = 1:9    
g0 = g0 + ni0(i)*tau^Ji0(i); gt0 = gt0 + ni0(i)*Ji0(i)*tau^(Ji0(i)-1); 
end 
gr = 0; gtr = 0; 
for i = 1:43    
gr = gr + ni(i)*pv^Ii(i) * (tau-0.5)^Ji(i);    
gtr = gtr + ni(i)*pv^Ii(i) * Ji(i)*(tau-0.5)^(Ji(i) - 1); 
end 
S2 = R*(tau*(gt0 + gtr) - (g0 + gr)); % Specific entropy (Table 12, Ref[1]) 
end  

function U2 = U2pt(P,T) 
% Parameters: Table 10 and 11 (Ref[1]) 
Ji0 = [0, 1, -5, -4, -3, -2, -1, 2, 3]; 
ni0 = [-9.6927686500217, 10.086655968018, -0.005608791128302,...    
0.071452738081455, -0.40710498223928, 1.4240819171444,...    
-4.383951131945, -0.28408632460772, 0.021268463753307]; 
Ii = [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 5, 6, 6, 6,...        
7, 7, 7, 8, 8, 9, 10, 10, 10, 16, 16, 18, 20, 20, 20, 21, 22, 23,...        
24, 24, 24]; 
Ji = [0, 1, 2, 3, 6, 1, 2, 4, 7, 36, 0, 1, 3, 6, 35, 1, 2, 3, 7, 3, 16,...        
35, 0, 11, 25, 8, 36, 13, 4, 10, 14, 29, 50, 57, 20, 35, 48, 21, 53,...        
39, 26, 40, 58]; 
ni = [-1.7731742473213e-03, -0.017834862292358, -0.045996013696365,...        
-0.057581259083432, -0.05032527872793, -3.3032641670203e-05,...        
-1.8948987516315e-04, -3.9392777243355e-03, -0.043797295650573,...        
-2.6674547914087e-05, 2.0481737692309e-08, 4.3870667284435e-07,...        
-3.227767723857e-05, -1.5033924542148e-03, -0.040668253562649,...        
-7.8847309559367e-10, 1.2790717852285e-08, 4.8225372718507e-07,...          
2.2922076337661e-06, -1.6714766451061e-11, -2.1171472321355e-03,...       
-23.895741934104, -5.905956432427e-18, -1.2621808899101e-06,...        
-0.038946842435739, 1.1256211360459e-11, -8.2311340897998,...         
1.9809712802088e-08, 1.0406965210174e-19, -1.0234747095929e-13,...         
-1.0018179379511e-09, -8.0882908646985e-11, 0.10693031879409,...        
-0.33662250574171, 8.9185845355421e-25, 3.0629316876232e-13,...        
-4.2002467698208e-06, -5.9056029685639e-26, 3.7826947613457e-06,...        
-1.2768608934681e-15, 7.3087610595061e-29, 5.5414715350778e-17,...        
-9.436970724121e-07]; 
R = 0.461526; %kJ/(kg-K) 
pv = P; tau = 540/T; % pv = P/P*, tau = T*/T, P*=1 Mpa, T*=540 K 
% Eqns in Table 12 and 13 (Ref[1]) 
gp0 = 1/pv; gt0 = 0; 
for i = 1:9, gt0 = gt0 + ni0(i)*Ji0(i)*tau^(Ji0(i)-1); end 
gpr = 0; gtr = 0; 
for i = 1:43  % Table 14 (Ref[1])    
gpr = gpr + ni(i)*Ii(i)*pv^(Ii(i)-1) * (tau-0.5)^Ji(i);    
gtr = gtr + ni(i)*pv^Ii(i)*Ji(i)*(tau-0.5)^(Ji(i)-1); 
end 
U2 = R*T*(tau*(gt0 + gtr) - pv*(gp0 + gpr)); % Specific internal energy (Table 12, Ref[1]) 
end  

function V2 = V2pt(P,T) 
% Parameters: Table 10 and 11 (Ref[1]) 
Ji0 = [0, 1, -5, -4, -3, -2, -1, 2, 3]; 
ni0 = [-9.6927686500217, 10.086655968018, -0.005608791128302,...          
0.071452738081455, -0.40710498223928, 1.4240819171444,...         
-4.383951131945, -0.28408632460772, 0.021268463753307]; 
Ii = [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 5, 6, 6, 6,...         
7, 7, 7, 8, 8, 9, 10, 10, 10, 16, 16, 18, 20, 20, 20, 21, 22, 23,...         
24, 24, 24]; 
Ji = [0, 1, 2, 3, 6, 1, 2, 4, 7, 36, 0, 1, 3, 6, 35, 1, 2, 3, 7, 3, 16,...          
35, 0, 11, 25, 8, 36, 13, 4, 10, 14, 29, 50, 57, 20, 35, 48, 21, 53,...          
39, 26, 40, 58]; 
ni = [-1.7731742473213e-03, -0.017834862292358, -0.045996013696365,...        
-0.057581259083432, -0.05032527872793, -3.3032641670203e-05,...    
-1.8948987516315e-04, -3.9392777243355e-03, -0.043797295650573,...    
-2.6674547914087e-05, 2.0481737692309e-08, 4.3870667284435e-07,...    
-3.227767723857e-05, -1.5033924542148e-03, -0.040668253562649,...    
-7.8847309559367e-10, 1.2790717852285e-08, 4.8225372718507e-07,...    
2.2922076337661e-06, -1.6714766451061e-11, -2.1171472321355e-03,...    
-23.895741934104, -5.905956432427e-18, -1.2621808899101e-06,...    
-0.038946842435739, 1.1256211360459e-11, -8.2311340897998,...    
1.9809712802088e-08, 1.0406965210174e-19, -1.0234747095929e-13,...    
-1.0018179379511e-09, -8.0882908646985e-11, 0.10693031879409,...    
-0.33662250574171, 8.9185845355421e-25, 3.0629316876232e-13,...    
-4.2002467698208e-06, -5.9056029685639e-26, 3.7826947613457e-06,...    
-1.2768608934681e-15, 7.3087610595061e-29, 5.5414715350778e-17,...    
-9.436970724121e-07]; 
R = 0.461526; %kJ/(kg-K) 
pv = P; tau = 540/T; % pv = P/P*, tau = T*/T, P*=1 Mpa, T*=540 K 
gp0 = 1/pv; gpr = 0; 
for i = 1:43, gpr = gpr + ni(i)*Ii(i)*pv^(Ii(i)-1) * (tau-0.5)^Ji(i); end 
V2 = R*T*pv*(gp0 + gpr)/P/1000;  % Specific volume (Table 12, Ref[1]) 
end  

% Equations for region 3 ------------------------------------------------- 
function P3s = P3sath(H) 
% Boundary equations psat(h) & psat(s) for the saturation line of region 3 
Ii = [0, 1, 1, 1, 1, 5, 7, 8, 14, 20, 22, 24, 28, 36]; 
Ji = [0, 1, 3, 4, 36, 3, 0, 24, 16, 16, 3, 18, 8, 24]; 
ni = [0.600073641753024, -9.36203654849857, 24.6590798594147,...         
-107.014222858224, -91582131580576.8, -8623.32011700662,...         
-23.5837344740032, 2.52304969384128e+17, -3.89718771997719e+18,...        
-3.33775713645296e+22, 35649946963.6328, -1.48547544720641e+26,...         
3.30611514838798e+18, 8.13641294467829e+37]; 
hs = H/2600; ps = 0;  
for i = 1:14, ps = ps + ni(i)*(hs-1.02)^Ii(i) * (hs-0.608)^Ji(i); end 
P3s = ps*22; 
end 
function S3 = S3rt(r,T) 
% Parameters: Table 30 (Ref[1]) 
Ii = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3,...         
4, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 8, 9, 9, 10, 10, 11]; 
Ji = [0, 0, 1, 2, 7, 10, 12, 23, 2, 6, 15, 17, 0, 2, 6, 7, 22, 26, 0, 2,...         
4, 16, 26, 0, 2, 4, 26, 1, 3, 26, 0, 2, 26, 2, 26, 2, 26, 0, 1, 26]; 
ni = [1.0658070028513, -15.732845290239, 20.944396974307, -7.6867707878716,...          
2.6185947787954, -2.808078114862, 1.2053369696517, -8.4566812812502e-03,...         
-1.2654315477714, -1.1524407806681, 0.88521043984318, -0.64207765181607,...         
0.38493460186671, -0.85214708824206, 4.8972281541877, -3.0502617256965,...          
0.039420536879154, 0.12558408424308, -0.2799932969871, 1.389979956946,...         
-2.018991502357, -8.2147637173963e-03, -0.47596035734923,...          
0.0439840744735, -0.44476435428739, 0.90572070719733, 0.70522450087967,...          
0.10770512626332, -0.32913623258954, -0.50871062041158,...       
-0.022175400873096, 0.094260751665092, 0.16436278447961,...    
-0.013503372241348, -0.014834345352472, 5.7922953628084e-04,...    
3.2308904703711e-03, 8.0964802996215e-05, -1.6557679795037e-04,...    
-4.4923899061815e-05]; 
R = 0.461526; %kJ/(Kg-K) 
Tc = 647.096; Pc = 22.064; rhoc = 322; % Critical parameters: Tc(K),Pc(MPa),rhoc 
(kg/m^3) 
delt = r/rhoc; tau = Tc/T; 
% Eqns in Table 32 (Ref[1]) 
phi = 0; phit = 0; 
for i = 2:40    
phi = phi + ni(i)*delt^Ii(i) * tau^Ji(i);    
phit = phit + ni(i)*delt^Ii(i) * Ji(i)*tau^(Ji(i)-1); 
end 
phi = phi + ni(1)*log(delt); 
S3 = R*(tau*phit - phi); % Specific entropy (Table 32, Ref[1]) 
end  

function U3 = U3rt(r,T) 
% Parameters: Table 30 (Ref[1]) 
Ii = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3,...         
4, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 8, 9, 9, 10, 10, 11]; 
Ji = [0, 0, 1, 2, 7, 10, 12, 23, 2, 6, 15, 17, 0, 2, 6, 7, 22, 26, 0, 2,...         
4, 16, 26, 0, 2, 4, 26, 1, 3, 26, 0, 2, 26, 2, 26, 2, 26, 0, 1, 26]; 
ni = [1.0658070028513, -15.732845290239, 20.944396974307, -7.6867707878716,...         
2.6185947787954, -2.808078114862, 1.2053369696517, -8.4566812812502e-03,...        
-1.2654315477714, -1.1524407806681, 0.88521043984318, -0.64207765181607,...        
0.38493460186671, -0.85214708824206, 4.8972281541877, -3.0502617256965,...        
0.039420536879154, 0.12558408424308, -0.2799932969871, 1.389979956946,...       
-2.018991502357, -8.2147637173963e-03, -0.47596035734923,...        
0.0439840744735, -0.44476435428739, 0.90572070719733, 0.70522450087967,...        
0.10770512626332, -0.32913623258954, -0.50871062041158,...       
-0.022175400873096, 0.094260751665092, 0.16436278447961,...       
-0.013503372241348, -0.014834345352472, 5.7922953628084e-04,...         
3.2308904703711e-03, 8.0964802996215e-05, -1.6557679795037e-04,...        
-4.4923899061815e-05]; 
R = 0.461526; %kJ/(Kg-K) 
Tc = 647.096; Pc = 22.064; rhoc = 322; % Critical parameters: Tc(K),Pc(MPa),rhoc 
(kg/m^3) 
delt = r/rhoc; tau = Tc/T; phit = 0; 
for i = 2:40, phit = phit + ni(i)*delt^Ii(i) * Ji(i)*tau^(Ji(i)-1); end 
U3 = R*T*tau*phit; % Specific internal energy (Table 32, Ref[1]) 
end  

function V3 = V3ph(P,H) 
% Backward equations T(p,h) and v(p,h) for subregions 3a and 3b (Ref[1]) 
h3ab = 2014.64004206875 + 3.74696550136983*P - 2.19921901054187e-02*P^2 +...    
8.7513168600995e-05*P^3; 
if H < h3ab % Subregion 3a    
Ii = [-12, -12, -12, -12, -10, -10, -10, -8, -8, -6, -6, -6, -4, -4,...          
-3, -2, -2, -1, -1, -1, -1, 0, 0, 1, 1, 1, 2, 2, 3, 4, 5, 8];    
Ji = [6, 8, 12, 18, 4, 7, 10, 5, 12, 3, 4, 22, 2, 3, 7, 3, 16, 0, 1,...           
2, 3, 0, 1, 0, 1, 2, 0, 2, 0, 2, 2, 2];    
ni = [5.29944062966028e-03, -0.170099690234461, 11.1323814312927,...           
-2178.98123145125, -5.06061827980875e-04, 0.556495239685324,...          
-9.43672726094016, -0.297856807561527, 93.9353943717186,...           
1.92944939465981e-02, 0.421740664704763, -3689141.2628233,...          
-7.37566847600639e-03, -0.354753242424366, -1.99768169338727,...           
1.15456297059049, 5683.6687581596, 8.08169540124668e-03,...           
0.172416341519307, 1.04270175292927, -0.297691372792847,...           
0.560394465163593, 0.275234661176914, -0.148347894866012,...          
-6.51142513478515e-02, -2.92468715386302, 6.64876096952665e-02,...           
3.52335014263844, -1.46340792313332e-02, -2.24503486668184,...           
1.10533464706142, -4.08757344495612e-02];    
ps = P/100; hs = H/2100; vs = 0;    
for i = 1:32, vs = vs + ni(i)*(ps+0.128)^Ii(i) * (hs-0.727)^Ji(i); end    
V3 = vs * 0.0028; 
else % Subregion 3b    
Ii = [-12, -12, -8, -8, -8, -8, -8, -8, -6, -6, -6, -6, -6, -6, -4,...           
-4, -4, -3, -3, -2, -2, -1, -1, -1, -1, 0, 1, 1, 2, 2];    
Ji = [0, 1, 0, 1, 3, 6, 7, 8, 0, 1, 2, 5, 6, 10, 3, 6, 10, 0, 2, 1,...            
2, 0, 1, 4, 5, 0, 0, 1, 2, 6];    
ni = [-2.25196934336318e-09, 1.40674363313486e-08, 2.3378408528056e-06,...           
-3.31833715229001e-05, 1.07956778514318e-03, -0.271382067378863,...            
1.07202262490333, -0.853821329075382, -2.15214194340526e-05,...           
7.6965608822273e-04, -4.31136580433864e-03, 0.453342167309331,...          
-0.507749535873652, -100.475154528389, -0.219201924648793,...          
-3.21087965668917, 607.567815637771, 5.57686450685932e-04,...            
0.18749904002955, 9.05368030448107e-03, 0.285417173048685,...           
3.29924030996098e-02, 0.239897419685483, 4.82754995951394,...          
-11.8035753702231, 0.169490044091791, -1.79967222507787e-02,...        
3.71810116332674e-02, -5.36288335065096e-02, 1.6069710109252];    
ps = P/100; hs = H/2800; vs = 0;    
for i = 1:30, vs = vs + ni(i)*(ps+0.0661)^Ii(i)*(hs-0.72)^Ji(i); end    
V3 = vs*0.0088; 
end 
end  

% Equations for region 4 ------------------------------------------------- 
function Ps = Ps4(T) 
% Eqn.(30) (saturation-pressure equation) (Ref[1]) 
% Valid temperature range: 273.15 K <= T <= 647.096 K 
thet = T - 0.23855557567849/(T - 650.17534844798); 
A = thet^2 + 1167.0521452767*thet - 724213.16703206; 
B = -17.073846940092*thet^2 + 12020.82470247*thet - 3232555.0322333; 
C = 14.91510861353*thet^2 - 4823.2657361591*thet + 405113.40542057; 
Ps = (2*C/(-B + (B^2 - 4*A*C)^0.5))^4; 
end  

function Ts = Ts4(P) 
% Eqn.(31) (saturation-temperature equation) (Ref[1]) 
% Valid pressure range: 611.213 Pa <= P <= 22.064 MPa 
beta = P^0.25; % Eqn.(29a) (Ref[1]), parameters: Table 34 (Ref[1]) 
E = beta^2 - 17.073846940092*beta + 14.91510861353; 
F = 1167.0521452767*beta^2 + 12020.82470247*beta - 4823.2657361591; 
G = -724213.16703206*beta^2 - 3232555.0322333*beta + 405113.40542057; 
D = 2*G / (-F - (F^2 - 4*E*G)^0.5); 
Ts = (650.17534844798 + D - ((650.17534844798 + D)^2 -...    
4*(-0.23855557567849 + 650.17534844798*D))^0.5) / 2; 
end  

function H4V = H4Vp(P) 
if (P > 0.000611657 & P < 22.06395) == 1    
Ts = Ts4(P);    
if P < 16.529, H4V = H2pt(P,Ts);    
else        
Lb = 2087.23500164864; Ub = 2568.592004; ps = -1000;        
while abs(P-ps) > 1e-6            
hm = (Lb + Ub)/2; ps = P3sath(hm);            
if ps < P, Ub = hm; else Lb = hm; end        
end        
H4V = hm;    
end 
else    
H4V = -1e5; 
end 
end  

function H4L = H4Lp(P) 
if (P > 0.000611657 & P < 22.06395) == 1    
Ts = Ts4(P);    
if P < 16.529, H4L = H1pt(P,Ts);    
else        
Lb = 1670.858218; Ub = 2087.23500164864; ps = -1000;        
while abs(P-ps) > 1e-5            
hm = (Lb + Ub)/2; ps = P3sath(hm);            
if ps > P, Ub = hm; else Lb = hm; end        
end        
H4L = hm;    
end 
else    
H4L = -1e5; 
end 
end  
