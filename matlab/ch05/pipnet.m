function fm = pipnet(m,rho,mu,D,L,rf) 
v = 4*m./(pi*D.^2*rho); Nre = D.*v*rho/mu; C = (7./Nre).^0.9 + 0.27*rf./D; 
A = (2.457*log(C)).^16; B = (37530./Nre).^16; f = 2*((8./Nre).^12 + 1./ ((A+B).^1.5)).^(1/12); 
dC = -(0.9./Nre).*(7./Nre).^0.9; dA = (39.312./C).*dC.*(2.457*log(C)).^15; dB = -16*B./Nre; 
b = (Nre/8)./((f/2).^12).*((8./Nre).^13 + (dA+dB)./((A+B).^2.5)); c = 32.*L./ (rho*pi^2*D.^5); 
a = f.*m.^b; phi = a.*c; 
fm = [m(1) + m(4) - 334;  m(1) - m(2) - m(5);  m(3) - m(4) + m(8);       
m(2) + m(3) - m(7) - m(9);  m(5) - m(6) - 42;  m(6) + m(7) - m(12) - 108;        
m(11) + m(12) - 9;  m(9) + m(10) - m(11) - 88;  m(8) - m(10) - 87;      
phi(1)*m(1)^(2-b(1)) + phi(2)*m(2)^(2-b(2)) - phi(3)*m(3)^(2-b(3)) - phi(4)*m(4)^(2-b(4));      
-phi(2)*m(2)^(2-b(2)) + phi(5)*m(5)^(2-b(5)) + phi(6)*m(6)^(2-b(6)) - phi(7)*m(7)^(2-b(7));      
phi(3)*m(3)^(2-b(3)) - phi(8)*m(8)^(2-b(8)) + phi(9)*m(9)^(2-b(9)) - phi(10)*m(10)^(2-b(10))]; 
end 