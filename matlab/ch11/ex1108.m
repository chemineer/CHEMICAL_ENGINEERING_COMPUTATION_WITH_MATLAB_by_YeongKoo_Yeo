% nnfitmoist.m 
clear all;  
xc1 = [0.0015 0.0076 0.0214 0.0273 0.0304 0.0263 0.0131 0.0087 0.0097 0.0069...    
0.0015 0.0143 0.0133 0.0083 0.0047 0.0039 0.0043 0.0032 0.0006 0.0056...    
0.0169 0.0240 0.0208 0.0125 0.0077 0.0086 0.0097 0.0117 0.0127 0.0083...    
0.0123 0.0243 0.0555 0.0619 0.0666 0.0763 0.0796 0.0820 0.0901 0.1051...    
0.1232 0.1313 0.1319 0.1387 0.1531 0.1636 0.1766 0.1940 0.2035 0.2092]; 
xc2 = [0.0365 0.0363 0.0361 0.0359 0.0357 0.0355 0.0353 0.0351 0.0350 0.0319...    
0.0169 0.0121 0.0119 0.0160 0.0227 0.0226 0.0224 0.0222 0.0220 0.0218...    
0.0216 0.0214 0.0192 0.0137 0.0149 0.0225 0.0224 0.0195 0.0120 0.0045... 
0.0009 0.0013 0.0024 0.0027 0.0030 0.0033 0.0036 0.0038 0.0041 0.0044...    
0.0046 0.0049 0.0052 0.0055 0.0057 0.0060 0.0063 0.0065 0.0068 0.0071]; 
xc3 = [0.0003 0.0007 0.0010 0.0013 0.0017 0.0020 0.0024 0.0027 0.0031 0.0034...    
0.0041 0.0044 0.0048 0.0051 0.0054 0.0058 0.0061 0.0065 0.0068 0.0072...    
0.0075 0.0078 0.0082 0.0085 0.0089 0.0092 0.0095 0.0099 0.0102 0.0106...    
0.0109 0.0112 0.0119 0.0123 0.0126 0.0129 0.0133 0.0136 0.0140 0.0143...    
0.0147 0.0150 0.0153 0.0157 0.0161 0.0160 0.0167 0.0170 0.0174 0.0177]; 
t = [0.0924 0.1665 0.2198 0.2121 0.2093 0.2271 0.2195 0.2074 0.1973 0.2503...    
0.2534 0.2769 0.2854 0.2886 0.2897 0.2924 0.2818 0.3950 0.3943 0.3899...    
0.3875 0.3863 0.3849 0.3872 0.3879 0.3913 0.3963 0.4031 0.4054 0.3968...    
0.3780 0.3733 0.3732 0.3828 0.3916 0.4053 0.4149 0.4196 0.4207 0.4237...    
0.4193 0.4007 0.3919 0.3726 0.3670 0.3785 0.3822 0.3932 0.4069 0.4109]; 
x = [xc1; xc2; xc3]; % input data matrix 
ppnet = fitnet(8); % one hidden layer with 8 neurons 
ppnet.divideParam.trainRatio = 0.6; 
ppnet.divideParam.valRatio = 0.2; 
ppnet.divideParam.testRatio = 0.2; 
[ppnet,tr] = train(ppnet,x,t); 
y = ppnet(x); % output calculation by network 
neterr = gsubtract(y,t); % error 
perm = perform(ppnet,t,y) % performance 
% Compare data and network output 
testx = x(:,tr.testInd); % input data set for test 
testt = t(:,tr.testInd); % target data set for test 
testy = ppnet(testx); % network output for test input data 
k = 1:length(tr.testInd);  
plot(k,testy,k,testt,'o'), xlabel('Sample no.'),ylabel('Moisture(%)') 
legend('Estimation by network','Data','Location','best') 